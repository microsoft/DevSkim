import{b as P,i as F}from"./chunk-2W6GW5U3.min.js";import{a as M}from"./chunk-EMCWWMW2.min.js";import{a as q}from"./chunk-CKZNVD2G.min.js";import{C as E,D as N,N as V,q as z}from"./chunk-F2VOIZPW.min.js";import{J as _,K as G,X as $,f as p,i as I,k as L,u as T}from"./chunk-JL6ISKUC.min.js";var R={},W=function(t){let s=Object.keys(t);for(let m of s)R[m]=t[m]},U=function(t,s,m,n,d,f){let w=n.select(`[id="${m}"]`);Object.keys(t).forEach(function(i){let l=t[i],h="default";l.classes.length>0&&(h=l.classes.join(" ")),h=h+" flowchart-label";let u=N(l.styles),e=l.text!==void 0?l.text:l.id,o;if(p.info("vertex",l,l.labelType),l.labelType==="markdown")p.info("vertex",l,l.labelType);else if(I(T().flowchart.htmlLabels)){let x={label:e.replace(/fa[blrs]?:fa-[\w-]+/g,k=>`<i class='${k.replace(":"," ")}'></i>`)};o=F(w,x).node(),o.parentNode.removeChild(o)}else{let x=d.createElementNS("http://www.w3.org/2000/svg","text");x.setAttribute("style",u.labelStyle.replace("color:","fill:"));let k=e.split(L.lineBreakRegex);for(let C of k){let v=d.createElementNS("http://www.w3.org/2000/svg","tspan");v.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),v.setAttribute("dy","1em"),v.setAttribute("x","1"),v.textContent=C,x.appendChild(v)}o=x}let c=0,r="";switch(l.type){case"round":c=5,r="rect";break;case"square":r="rect";break;case"diamond":r="question";break;case"hexagon":r="hexagon";break;case"odd":r="rect_left_inv_arrow";break;case"lean_right":r="lean_right";break;case"lean_left":r="lean_left";break;case"trapezoid":r="trapezoid";break;case"inv_trapezoid":r="inv_trapezoid";break;case"odd_right":r="rect_left_inv_arrow";break;case"circle":r="circle";break;case"ellipse":r="ellipse";break;case"stadium":r="stadium";break;case"subroutine":r="subroutine";break;case"cylinder":r="cylinder";break;case"group":r="rect";break;case"doublecircle":r="doublecircle";break;default:r="rect"}s.setNode(l.id,{labelStyle:u.labelStyle,shape:r,labelText:e,labelType:l.labelType,rx:c,ry:c,class:h,style:u.style,id:l.id,link:l.link,linkTarget:l.linkTarget,tooltip:f.db.getTooltip(l.id)||"",domId:f.db.lookUpDomId(l.id),haveCallback:l.haveCallback,width:l.type==="group"?500:void 0,dir:l.dir,type:l.type,props:l.props,padding:T().flowchart.padding}),p.info("setNode",{labelStyle:u.labelStyle,labelType:l.labelType,shape:r,labelText:e,rx:c,ry:c,class:h,style:u.style,id:l.id,domId:f.db.lookUpDomId(l.id),width:l.type==="group"?500:void 0,type:l.type,dir:l.dir,props:l.props,padding:T().flowchart.padding})})},H=function(t,s,m){p.info("abc78 edges = ",t);let n=0,d={},f,w;if(t.defaultStyle!==void 0){let a=N(t.defaultStyle);f=a.style,w=a.labelStyle}t.forEach(function(a){n++;var i="L-"+a.start+"-"+a.end;d[i]===void 0?(d[i]=0,p.info("abc78 new entry",i,d[i])):(d[i]++,p.info("abc78 new entry",i,d[i]));let l=i+"-"+d[i];p.info("abc78 new link id to be used is",i,l,d[i]);var h="LS-"+a.start,u="LE-"+a.end;let e={style:"",labelStyle:""};switch(e.minlen=a.length||1,a.type==="arrow_open"?e.arrowhead="none":e.arrowhead="normal",e.arrowTypeStart="arrow_open",e.arrowTypeEnd="arrow_open",a.type){case"double_arrow_cross":e.arrowTypeStart="arrow_cross";case"arrow_cross":e.arrowTypeEnd="arrow_cross";break;case"double_arrow_point":e.arrowTypeStart="arrow_point";case"arrow_point":e.arrowTypeEnd="arrow_point";break;case"double_arrow_circle":e.arrowTypeStart="arrow_circle";case"arrow_circle":e.arrowTypeEnd="arrow_circle";break}let o="",c="";switch(a.stroke){case"normal":o="fill:none;",f!==void 0&&(o=f),w!==void 0&&(c=w),e.thickness="normal",e.pattern="solid";break;case"dotted":e.thickness="normal",e.pattern="dotted",e.style="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":e.thickness="thick",e.pattern="solid",e.style="stroke-width: 3.5px;fill:none;";break;case"invisible":e.thickness="invisible",e.pattern="solid",e.style="stroke-width: 0;fill:none;";break}if(a.style!==void 0){let r=N(a.style);o=r.style,c=r.labelStyle}e.style=e.style+=o,e.labelStyle=e.labelStyle+=c,a.interpolate!==void 0?e.curve=E(a.interpolate,$):t.defaultInterpolate!==void 0?e.curve=E(t.defaultInterpolate,$):e.curve=E(R.curve,$),a.text===void 0?a.style!==void 0&&(e.arrowheadStyle="fill: #333"):(e.arrowheadStyle="fill: #333",e.labelpos="c"),e.labelType=a.labelType,e.label=a.text.replace(L.lineBreakRegex,`
`),a.style===void 0&&(e.style=e.style||"stroke: #333; stroke-width: 1.5px;fill:none;"),e.labelStyle=e.labelStyle.replace("color:","fill:"),e.id=l,e.classes="flowchart-link "+h+" "+u,s.setEdge(a.start,a.end,e,n)})},X=function(t,s){p.info("Extracting classes"),s.db.clear();try{return s.parse(t),s.db.getClasses()}catch{return}},J=function(t,s,m,n){p.info("Drawing flowchart"),n.db.clear(),P.setGen("gen-2"),n.parser.parse(t);let d=n.db.getDirection();d===void 0&&(d="TD");let{securityLevel:f,flowchart:w}=T(),a=w.nodeSpacing||50,i=w.rankSpacing||50,l;f==="sandbox"&&(l=_("#i"+s));let h=f==="sandbox"?_(l.nodes()[0].contentDocument.body):_("body"),u=f==="sandbox"?l.nodes()[0].contentDocument:document,e=new q({multigraph:!0,compound:!0}).setGraph({rankdir:d,nodesep:a,ranksep:i,marginx:0,marginy:0}).setDefaultEdgeLabel(function(){return{}}),o,c=n.db.getSubGraphs();p.info("Subgraphs - ",c);for(let b=c.length-1;b>=0;b--)o=c[b],p.info("Subgraph - ",o),n.db.addVertex(o.id,{text:o.title,type:o.labelType},"group",void 0,o.classes,o.dir);let r=n.db.getVertices(),x=n.db.getEdges();p.info("Edges",x);let k=0;for(k=c.length-1;k>=0;k--){o=c[k],G("cluster").append("text");for(let b=0;b<o.nodes.length;b++)p.info("Setting up subgraphs",o.nodes[b],o.id),e.setParent(o.nodes[b],o.id)}U(r,e,s,h,u,n),H(x,e);let C=h.select(`[id="${s}"]`),v=h.select("#"+s+" g");if(M(v,e,["point","circle","cross"],"flowchart",s),V.insertTitle(C,"flowchartTitleText",w.titleTopMargin,n.db.getDiagramTitle()),z(e,C,w.diagramPadding,w.useMaxWidth),n.db.indexNodes("subGraph"+k),!w.htmlLabels){let b=u.querySelectorAll('[id="'+s+'"] .edgeLabel .label');for(let g of b){let S=g.getBBox(),y=u.createElementNS("http://www.w3.org/2000/svg","rect");y.setAttribute("rx",0),y.setAttribute("ry",0),y.setAttribute("width",S.width),y.setAttribute("height",S.height),g.insertBefore(y,g.firstChild)}}Object.keys(r).forEach(function(b){let g=r[b];if(g.link){let S=_("#"+s+' [id="'+b+'"]');if(S){let y=u.createElementNS("http://www.w3.org/2000/svg","a");y.setAttributeNS("http://www.w3.org/2000/svg","class",g.classes.join(" ")),y.setAttributeNS("http://www.w3.org/2000/svg","href",g.link),y.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),f==="sandbox"?y.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):g.linkTarget&&y.setAttributeNS("http://www.w3.org/2000/svg","target",g.linkTarget);let A=S.insert(function(){return y},":first-child"),B=S.select(".label-container");B&&A.append(function(){return B.node()});let D=S.select(".label");D&&A.append(function(){return D.node()})}}})},re={setConf:W,addVertices:U,addEdges:H,getClasses:X,draw:J},K=t=>`.label {
    font-family: ${t.fontFamily};
    color: ${t.nodeTextColor||t.textColor};
  }
  .cluster-label text {
    fill: ${t.titleColor};
  }
  .cluster-label span,p {
    color: ${t.titleColor};
  }

  .label text,span,p {
    fill: ${t.nodeTextColor||t.textColor};
    color: ${t.nodeTextColor||t.textColor};
  }

  .node rect,
  .node circle,
  .node ellipse,
  .node polygon,
  .node path {
    fill: ${t.mainBkg};
    stroke: ${t.nodeBorder};
    stroke-width: 1px;
  }
  .flowchart-label text {
    text-anchor: middle;
  }
  // .flowchart-label .text-outer-tspan {
  //   text-anchor: middle;
  // }
  // .flowchart-label .text-inner-tspan {
  //   text-anchor: start;
  // }

  .node .label {
    text-align: center;
  }
  .node.clickable {
    cursor: pointer;
  }

  .arrowheadPath {
    fill: ${t.arrowheadColor};
  }

  .edgePath .path {
    stroke: ${t.lineColor};
    stroke-width: 2.0px;
  }

  .flowchart-link {
    stroke: ${t.lineColor};
    fill: none;
  }

  .edgeLabel {
    background-color: ${t.edgeLabelBackground};
    rect {
      opacity: 0.5;
      background-color: ${t.edgeLabelBackground};
      fill: ${t.edgeLabelBackground};
    }
    text-align: center;
  }

  .cluster rect {
    fill: ${t.clusterBkg};
    stroke: ${t.clusterBorder};
    stroke-width: 1px;
  }

  .cluster text {
    fill: ${t.titleColor};
  }

  .cluster span,p {
    color: ${t.titleColor};
  }
  /* .cluster div {
    color: ${t.titleColor};
  } */

  div.mermaidTooltip {
    position: absolute;
    text-align: center;
    max-width: 200px;
    padding: 2px;
    font-family: ${t.fontFamily};
    font-size: 12px;
    background: ${t.tertiaryColor};
    border: 1px solid ${t.border2};
    border-radius: 2px;
    pointer-events: none;
    z-index: 100;
  }

  .flowchartTitleText {
    text-anchor: middle;
    font-size: 18px;
    fill: ${t.textColor};
  }
`,ae=K;export{re as a,ae as b};
//# sourceMappingURL=chunk-MTDFBIHI.min.js.map
